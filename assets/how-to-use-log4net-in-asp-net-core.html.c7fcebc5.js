import{r as a,o as t,c as p,b as n,a as e,F as o,e as c,d as l}from"./app.d1ef40ff.js";import{_ as u}from"./plugin-vue_export-helper.21dcd24c.js";const r={},i=c(`<h2 id="\u65B0\u5EFA" tabindex="-1"><a class="header-anchor" href="#\u65B0\u5EFA" aria-hidden="true">#</a> \u65B0\u5EFA</h2><p>\u65B0\u5EFA\u4E00\u4E2A\u57FA\u4E8E .net core\u7684Web api\u9879\u76EE</p><h2 id="\u5B89\u88C5" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5" aria-hidden="true">#</a> \u5B89\u88C5</h2><p>\u5728Nuget\u4E2D\u641C\u7D22\u5E76\u5B89\u88C5<code>Microsoft.Extensions.Logging.Log4Net.AspNetCore</code>\u5305</p><h2 id="\u6DFB\u52A0" tabindex="-1"><a class="header-anchor" href="#\u6DFB\u52A0" aria-hidden="true">#</a> \u6DFB\u52A0</h2><p>\u4FEE\u6539<code>Program</code>\u6587\u4EF6\u7684<code>CreateHostBuilder</code>\u65B9\u6CD5</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IHostBuilder</span> <span class="token function">CreateHostBuilder</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    Host<span class="token punctuation">.</span><span class="token function">CreateDefaultBuilder</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span>
        <span class="token comment">/* \u4EE5\u4E0B\u4E3A\u65B0\u589E\u4EE3\u7801\u7247\u6BB5 */</span>
        <span class="token punctuation">.</span><span class="token function">ConfigureLogging</span><span class="token punctuation">(</span>loggingBuilder <span class="token operator">=&gt;</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// \u8FC7\u6EE4\u6389 System \u548C Microsoft \u5F00\u5934\u7684\u547D\u540D\u7A7A\u95F4\u4E0B\u7684\u7EC4\u4EF6\u4EA7\u751F\u7684\u8B66\u544A\u7EA7\u522B\u4EE5\u4E0B\u7684\u65E5\u5FD7</span>
            loggingBuilder<span class="token punctuation">.</span><span class="token function">AddFilter</span><span class="token punctuation">(</span><span class="token string">&quot;System&quot;</span><span class="token punctuation">,</span> LogLevel<span class="token punctuation">.</span>Warning<span class="token punctuation">)</span><span class="token punctuation">;</span>
            loggingBuilder<span class="token punctuation">.</span><span class="token function">AddFilter</span><span class="token punctuation">(</span><span class="token string">&quot;Microsoft&quot;</span><span class="token punctuation">,</span> LogLevel<span class="token punctuation">.</span>Warning<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6DFB\u52A0log4net\uFF0C\u91CD\u8F7D\u65B9\u6CD5\u91CC\u9762\u53EF\u4EE5\u6307\u5B9Alog4net\u7684\u914D\u7F6E\u6587\u4EF6\u8DEF\u5F84</span>
            loggingBuilder<span class="token punctuation">.</span><span class="token function">AddLog4Net</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E" aria-hidden="true">#</a> \u914D\u7F6E</h2><p>\u5728\u9879\u76EE\u6839\u76EE\u5F55\u4E0B\u6DFB\u52A0log4net.config\uFF0C\u5E76\u5C06\u5176\u201C\u590D\u5236\u5230\u8F93\u51FA\u76EE\u5F55\u201D\u5C5E\u6027\u8BBE\u7F6E\u4E3A&quot;\u5982\u679C\u8F83\u65B0\u5219\u590D\u5236&quot;</p><blockquote><p><em>log4net\u9ED8\u8BA4\u914D\u7F6E\u6587\u4EF6\u540D\u79F0\u4E3Alog4net.config\uFF0C\u5982\u679C\u4FEE\u6539\u4E86\u6587\u4EF6\u540D\uFF0C\u53EF\u5728\u4E0A\u9762\u7684\u4EE3\u7801<code>loggingBuilder.AddLog4Net();</code>\u91CD\u8F7D\u65B9\u6CD5\u4E2D\u652F\u6301\u8F93\u5165\u6587\u4EF6\u540D\u53C2\u6570</em></p></blockquote><p>\u6587\u4EF6\u7684\u914D\u7F6E\u65B9\u5F0F\u53EF\u53C2\u8003\u7F51\u4E0A\u6587\u6863\uFF0C\u8FD9\u91CC\u8282\u9009\u5176\u4E2D\u4E00\u79CD\u91C7\u7528\u6587\u4EF6\u9644\u52A0\u65B9\u5F0F</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log4net</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>FileAppender<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>log4net.Appender.FileAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Logs/log.txt<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appendToFile</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>log4net.Layout.PatternLayout<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>conversionPattern</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>%date [%thread] %-5level %logger - %message%newline<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layout</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ALL<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>FileAppender<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>log4net</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="\u8C03\u7528" tabindex="-1"><a class="header-anchor" href="#\u8C03\u7528" aria-hidden="true">#</a> \u8C03\u7528</h2><p>\u8C03\u7528\u65B9\u5F0F\u6CA1\u6709\u5DEE\u522B\uFF0C\u5C31\u662F\u76F4\u63A5\u91C7\u7528logging\u7684\u65B9\u5F0F</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FoobarController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ControllerBase</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">ILogger<span class="token punctuation">&lt;</span>FoobarController<span class="token punctuation">&gt;</span></span> _logger<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">FoobarController</span><span class="token punctuation">(</span><span class="token class-name">ILogger<span class="token punctuation">&lt;</span>FoobarController<span class="token punctuation">&gt;</span></span> logger<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _logger <span class="token operator">=</span> logger<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpGet</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _logger<span class="token punctuation">.</span><span class="token function">LogError</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        _logger<span class="token punctuation">.</span><span class="token function">LogWarning</span><span class="token punctuation">(</span><span class="token string">&quot;warn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        _logger<span class="token punctuation">.</span><span class="token function">LogInformation</span><span class="token punctuation">(</span><span class="token string">&quot;info&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>\u542F\u52A8\u9879\u76EE\uFF0C\u8C03\u7528\u5F53\u524D\u63A7\u5236\u5668\u7684\u65B9\u6CD5\u3002</p><p>\u7136\u540E\u6211\u4EEC\u6253\u5F00\u9879\u76EE\uFF0C\u627E\u5230bin\u76EE\u5F55\u4E0B\u7684Logs\u6587\u4EF6\u5939\uFF08log4net.config\u4E2D\u914D\u7F6E\u7684\u8DEF\u5F84\uFF09\uFF0C\u5C31\u53EF\u4EE5\u770B\u5230\u4E00\u4E2Alog.txt\u6587\u4EF6\uFF0C\u6253\u5F00\u6587\u4EF6\u53EF\u4EE5\u770B\u5230\u6211\u4EEC\u8C03\u7528\u7684\u65E5\u5FD7\u4FE1\u606F\u90FD\u8BB0\u5F55\u4E86</p><h2 id="\u76F8\u5173\u94FE\u63A5" tabindex="-1"><a class="header-anchor" href="#\u76F8\u5173\u94FE\u63A5" aria-hidden="true">#</a> \u76F8\u5173\u94FE\u63A5</h2>`,18),k={href:"https://www.jianshu.com/p/e4d3bec9e220",title:".NET Core \u65E5\u5FD7\u6536\u96C6\uFF08log4net+Kafka+ELK\uFF09",target:"_blank",rel:"noopener noreferrer"},g=l(".NET Core \u65E5\u5FD7\u6536\u96C6\uFF08log4net+Kafka+ELK\uFF09");function d(b,m){const s=a("ExternalLinkIcon");return t(),p(o,null,[i,n("p",null,[n("a",k,[g,e(s)])])],64)}var q=u(r,[["render",d]]);export{q as default};
